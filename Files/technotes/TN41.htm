<html><HEAD>  <TITLE>Tech Note 41: Using foSync to talk to ODBC Servers  </TITLE>  <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">  <META Name="keywords" Content="NSBASIC,VPN,Enterprise synchronization software,        sync software,synchronization software,synchronization,Wince,Handheld,        PDA,Palm,Palm Pilot,PalmOS,PocketPC,Handhelds,Fundamental Objects,Servers">  <STYLE>  BODY {	font-family: "Arial";	font-size: 10pt;  	font-style: normal;        color:000080;      }   td {	font-family:arial;        font-size:10pt;        color:000080;      }  A:HOVER {		 	font-family:arial;        font-size:10pt;        color:000080;	text-decoration: none;	background-color:FFCC99;      }  A:Visited {	 	font-family:arial;        font-size:10pt;        color:000080;	Text-decoration: underline; 	color: "663300";	      }  A:Link   {	 	font-family:arial;        font-size:10pt;        color:000080;	Text-decoration: underline; 	color: "blue";     }  </STYLE><SCRIPT language="javascript"><!--   function PopWin(ItemID)     {	var winLeft = (screen.width / 2)  - (710 / 2) - 20;	var winTop = (screen.height / 2)  - (530 / 2) - 20;       var nW = window.open("XXXXXXX",null,"top=" + winTop + ",left=" + winLeft + "," +		       "width=710,height=530," +  		       "scrollbars=no,toolbar=no,resizable=no," +  		       "titlebar=no,location=no");      // nW.location.href = "addprice.asp";      // nW = null;      }--></SCRIPT></HEAD><BODY TEXT="#000000" LINK="#0000ff" VLINK="#800080" BGCOLOR="#ffffff"><TABLE CELLSPACING=0 BORDER=0 WIDTH=478><TR><TD WIDTH="22%" VALIGN="TOP"><P><IMG SRC="images/BigIcon.GIF" WIDTH=86 HEIGHT=103></TD><TD WIDTH="78%" VALIGN="TOP"><B><FONT FACE="Helvetica" SIZE=5>      <P>Tech Note 41: Using foSync to talk to ODBC Servers, without a Conduit</P>      <P>September 29, 2005</P></FONT><FONT FACE="Helvetica" SIZE=2><P>submitted by: <A href="http://www.fo.com/contactus.asp">Fundamental Objects</a></font></B></TD></TR></TABLE><HR><h2>Contents:</h2><pre>    <a href="#intro">Introduction</a>    <a href="#winceexp">A Small, working NSBasic Example</a>    <a href="#links">Related Links</a></pre><a name="intro"><h2>Introduction:</h2><TABLE CELLSPACING="0" CELLPADDING="0" BORDER="0"><TR valign="top"><TD  WIDTH="350">SYNCHRONIZATION WITH NSBASIC<br><br><B>foSync</b>&trade; is a standalone toolset, that makes it easier to move data that has been captured in a NSBasic file, back and forth to;<BR><BR>&nbsp;&nbsp;&nbsp;a <B>corporate</B> database;<BR>&nbsp;&nbsp;&nbsp;&nbsp;<i>or</i>,<BR>&nbsp;&nbsp;&nbsp;a <B>web-hosted</B> database<BR>&nbsp;&nbsp;&nbsp;&nbsp;<i>or</i>,<BR>&nbsp;&nbsp;&nbsp;a location <B>on your LAN</B> or web server.<BR><BR>This "data" can be Pocket PC CDB data, Palm PDB data or even complete physical files, such as PPC executables or Palm PRC files. </TD><TD WIDTH="12">&nbsp;</TD><TD ALIGN="center"><img src="images/tn41a.gif" width="394" height="260"><BR><font style="font-family:arial;font-size:9pt;color:000080;">foSync</FONT></TD></TR></TABLE><TABLE CELLSPACING="0" CELLPADDING="0" BORDER="0"><TR><TD  WIDTH="600"><br>foSync is an enterprise-level tool; featuring security, speed (data is compressed) and, flexibility -- no conduits are required.<br><br><b>How it Works</b><br><br>foSync is a standalone executable that can be called from NSBasic. A configuration file is set up that determines which fields of data on the PDA side are transferred to (and optionally, back from) the server. A  Windows service is run on the server to accept data from PDAs being synchronized. This service handles multiple instances simultaneously.<br><br>The base foSync product will transfer ALL of the fields in the associated PDA database to the server. Users will be able to have records deleted, added or changed, depending upon how your application wishes them to be marked. Data can be moved wirelessly to the server, or handled in <a href="#"  title="'disconnected' - where data is moved to the server during hotsync/activesyncing." onclick="javascript:return false;">disconnected</a> manner, being synced when next connected online to the server. All that is really required is an open IP connection.<br><br>Data that is moved to the server is encrypted and compressed -- which in and of itself is really worth using foSync alone. foSync has demonstrated customer sync times up to 5x faster than XTND Connect, a widely used and much more expensive alternative.<br><br><br><b>Moving files</b><br><br>If you receive a physical file from the server as part of your sync, the file will be dropped into a specified folder on the PDA. If that folder does not exist -- the user will be prompted before creating it. The user can choose a different folder and that folder then becomes their individual default.<BR><BR></TD><TD WIDTH="6">&nbsp;</TD><TD ALIGN="center">&nbsp;</TD></TR></TABLE><HR><a name="winceexp"><h2>A Small, working NSBasic Example:</h2><TABLE CELLSPACING="0" CELLPADDING="0" BORDER="0"><TR><TD WIDTH="6">&nbsp;</TD><TD ALIGN="center"><img src="images/tn41b.gif" width="242" height="322"><BR><font </TD><TD WIDTH="12">&nbsp;</TD><TD ALIGN="left" WIDTH="450">This is a simple NSBasic application that you can download to try. It models a wireless sync situation.<br><br>This example allows the user to enter a userid and password, (which can be used to access an online site to see the changes immediately). You can also enter a block of text to move to the server. Tapping the Sync! button will transfer your data to a web-based database, which you can then visit to confirm this action.<br><br><b>Usage</b><br><br>This example can be downloaded and run yourself from here (<a href="http://www.fo.com/downloads/nsb-demo.zip">http://www.fo.com/downloads/nsb-demo.zip</a>).<br><br>Download and place this example onto a PalmOS 4+ PDA. Then, on the PDA with an open IP connection to the internet -- enter <i>YOUR</i> userid and password (anything is fine, as long as you remember it for the next step), and a portion of text that you want to send to the server. Now tap Sync! </TD></TR></TABLE><br><TABLE CELLSPACING="0" CELLPADDING="0" BORDER="0"><TR><TD WIDTH="6">&nbsp;</TD><TD ALIGN="left" WIDTH="600">You can then see the entry that you've made into a web database. Log into the NSBasic sample page at FO (<a href="http://www.fo.com/nsdemo.asp">http://www.fo.com/nsdemo.asp</a>), using the UserID and Password that you entered into the application, and you will see a record with your data on it along with some of the basic synchronization messages that this toolset provides for adminstration.  </TD></TR></TABLE><TABLE CELLSPACING="0" CELLPADDING="0" BORDER="0"><TR><TD WIDTH="6">&nbsp;</TD><TD ALIGN="left" WIDTH="600"><br><br><b>What would you use foSync for?</b><br><br>The tool allows NSBasic to easily interoperate with ODBC-compliant databases, such as SQL Server, Oracle and MS Access. You can use the combination to update records on a web-based database; retrieve extended information -- such as error codes and text, where the error information can be updated centrally over time -- or even to move files back and forth to the server. </TD></TR></TABLE><TABLE CELLSPACING="0" CELLPADDING="0" BORDER="0"><TR><TD WIDTH="6">&nbsp;</TD><TD ALIGN="left" WIDTH="600"><br><br><b>How Would You <i>Use</i> foSync?</b><br><br>To use this tool, you would define which fields within your PDA database  should be moved back (and forth) to the server when the sync occurs. Newly added rows are ADDED to the server database and DELETED rows removed.<br><br><b>Files on the PDA</b><br>There are 4 files required on the PDA to sync (and 2 are created during the processing itself).<br>They are:<br>&nbsp;&nbsp;<TABLE CELLSPACING="0" CELLPADDING="2" BORDER="1" bgcolor="CCFFFF"><TR bgcolor="000080" style="color:FFFFFF;"><td><font color="FFFFFF">Created</font></td><td><font color="FFFFFF">Filename</font></td><td><font color="FFFFFF">Purpose</font></td></tr><TR><td>&nbsp;</td><td>NSSyncDemo.prc</td><td>The NSBasic demo itself.</td></tr><TR><td>&nbsp;</td><td>NSSync.prc</td><td>"fo"Sync for NSBasic.</td></tr><TR><td>&nbsp;</td><td>FOZlib.prc</td><td>Data compression library.</td></tr><TR><td>&nbsp;</td><td>SyncConfig.pdb</td><td>Setup parms for foSync.</td></tr><TR><td>Created</td><td>SyncStatus.pdb</td><td>Control file to start foSync with.</td></tr><TR><td>Created</td><td>nsf1.pdb</td><td>The actual data to move.</td></tr></TABLE><br><img src="images/tn41c.gif"><BR><font size="1" color="000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Files shown in Launcher</font><br><br><br><b>API</b><br>The "API" to call foSync is fairly simple.<br>>From your NSBasic application, call the foSync application incode, or from a "Sync" button. For Example, first create theSyncStatus pdb, to associate foSync to your application:<br><br>    <font color="0000FF">If</font> rc <> 0 <font color="0000FF">Then</font><br>&nbsp;&nbsp;&nbsp;       MsgBox str(rc) + " on <font color="FF0000">SyncStatus create."</font><br>    <font color="0000FF">Else</font><br>&nbsp;&nbsp;&nbsp;      rc=DBOPEN(CustomerDB,<font color="FF0000">"SyncStatus"</font>,0)<br>&nbsp;&nbsp;&nbsp;      rc=DbInsert(CustomerDb, <font color="FF0000">"Y"</font>, <font color="FF0000">"NSSyncDemo"</font>,<font color="FF0000">""</font>,<font color="FF0000">""</font>) <br>&nbsp;&nbsp;&nbsp;      rc=DbClose(CustomerDb)<br><font color="0000FF">End If</font> <br><br><br>Place the data to be synchronized into nsf1.pdb.<br>Thenstart the sync.<br><br><br><font color="0000FF">Sub</font> RunSync()<br><br>&nbsp;&nbsp;&nbsp;<font color="0000FF">Chain</font> 0,<font color="0000FF">"NSSync"</font><br><br><font color="0000FF">End Sub</font><br><br>The demo that you can request below requires no coding on <br>your part, as it is a self contained NSBasic application. <br><br><table cellspacing="0" cellpadding="2" width="600"><tr valign="middle"><td>When you begin the sync process -- a separate screen (right) will be displayed as the files are syncronized with the server.<br><br>Once the sync has completed, you can either return control to your program (to check the status) or exit.</td><td align="center"><img src="images/tn41d.gif"><font size="1" color="000000"><br>A sync in Process</font></TD></TR></TABLE><br><br>More sophistication, such as conditionally moving rows, based upon their contents -- or resolving complex user key situations, can be customized for individual situations as well.<br><br><a name="links"><h2>Related Links:</h2><TABLE CELLSPACING="0" CELLPADDING="3" BORDER="0"><TR><td><a href="http://www.fo.com/contactus.asp?txtCommentType=5" target="_blank">Request the NSBasic foSync demo</a></td></tr><TR><td><a href="http://www.fo.com/getpage.asp?strfile=pda/fosync.htm" target="_blank">foSync</a></td></tr></table></pre><center><font face="arial" style="font-size:8pt;color:808080;"><br><br>Updated October 17, 2005, Fundamental Objects, Inc.<br></font></center></body></html>